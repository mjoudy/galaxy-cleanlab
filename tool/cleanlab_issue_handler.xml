<tool id="cleanlab_issue_handler" name="Cleanlab Issue Handler" version="1.0.0">
    <description>Detect and optionally clean data issues using Cleanlab</description>

    <requirements>
        <container type="docker">galaxy_cleanlab/issue_handler:first_docker</container>
    </requirements>

    <command detect_errors="exit_code"><![CDATA[
    python /app/cleanlab_issue_handler.py
        --csv '$input_file'
        --task '$task'
        --method '$method'
    #if $summary_only:
        --summary
    #end if
    ]]></command>


    <inputs>
        <param name="input_file" type="data" format="csv" label="Input CSV file (must contain 'target' column)"/>
        <param name="task" type="select" label="Task type">
            <option value="classification">Classification</option>
            <option value="regression">Regression</option>
        </param>
        <param name="method" type="select" label="Cleaning method">
            <option value="remove">Remove problematic rows</option>
            <option value="replace">Replace problematic labels (classification only)</option>
        </param>
        <param name="summary_only" type="boolean" label="Only report issues (do not clean data)" checked="true"/>
    </inputs>

    <outputs>
        <data name="report_file" from_work_dir="summary.txt" format="txt" label="Issue Report"/>
        <data name="output_file" from_work_dir="cleaned_data.csv" format="csv" label="Cleaned Dataset">
            <filter>summary_only == "false"</filter>
        </data>
    </outputs>

    <help>
        <![CDATA[
        This tool uses Cleanlab to detect and optionally clean issues in labeled data.
        ]]>
    </help>
</tool>

